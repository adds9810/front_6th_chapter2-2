import{j as e,r as x,R as Y,a as Z}from"./client-DvaAtPIX.js";const B=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),F=()=>e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),ee=()=>e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),se=()=>e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),te=()=>e.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),ne=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),ae=()=>e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})});function g({children:s,className:t,hasTransition:n=!1,hasFontMedium:l=!1,hasTextSm:c=!1,hasRounded:a=!1,...r}){const i="focus:outline-none",o=[n&&"transition-colors",l&&"font-medium",c&&"text-sm",a&&"rounded"].filter(Boolean),d=[i,...o,t].filter(Boolean).join(" ");return e.jsx("button",{className:d,...r,children:s})}function w({label:s,className:t,...n}){const c=["w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",t].filter(Boolean).join(" ");return e.jsxs("div",{className:"w-full",children:[s&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s}),e.jsx("input",{className:c,...n})]})}const re=({isAdmin:s,searchTerm:t,setSearchTerm:n,setIsAdmin:l,cart:c,totalItemCount:a})=>e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!s&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx(w,{type:"text",value:t,onChange:r=>n(r.target.value),placeholder:"상품 검색...",className:"px-4 py-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx(g,{onClick:()=>l(!s),hasTransition:!0,hasTextSm:!0,hasRounded:!0,className:`px-3 py-1.5 ${s?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:s?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!s&&e.jsxs("div",{className:"relative",children:[e.jsx(F,{}),c.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:a})]})]})]})})}),le=({notifications:s,onRemoveNotification:t})=>s.length===0?null:e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:s.map(n=>e.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${n.type==="error"?"bg-red-600":n.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[e.jsx("span",{className:"mr-2",children:n.message}),e.jsx(g,{onClick:()=>t(n.id),className:"text-white hover:text-gray-200",children:e.jsx(B,{})})]},n.id))}),ce=({activeTab:s,setActiveTab:t})=>e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx(g,{onClick:()=>t("products"),hasTransition:!0,hasFontMedium:!0,hasTextSm:!0,className:`py-2 px-1 border-b-2 ${s==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),e.jsx(g,{onClick:()=>t("coupons"),hasTransition:!0,hasFontMedium:!0,hasTextSm:!0,className:`py-2 px-1 border-b-2 ${s==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),ie=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],oe=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],L={name:"",price:0,stock:0,description:"",discounts:[]},$={name:"",code:"",discountType:"amount",discountValue:0},de=(s,t)=>!t.find(l=>l.code===s),ue=s=>s.discountType==="amount"?`${s.discountValue.toLocaleString()}원 할인`:`${s.discountValue}% 할인`,xe=(s,t)=>{if(s==="percentage"){if(t>100)return{isValid:!1,correctedValue:100,errorMessage:"할인율은 100%를 초과할 수 없습니다"};if(t<0)return{isValid:!1,correctedValue:0}}else{if(t>1e5)return{isValid:!1,correctedValue:1e5,errorMessage:"할인 금액은 100,000원을 초과할 수 없습니다"};if(t<0)return{isValid:!1,correctedValue:0}}return{isValid:!0}},me=s=>s==="amount"?"할인 금액":"할인율(%)",he=s=>s==="amount"?"5000":"10",ge=(s,t)=>s.discountType==="amount"?s.discountValue:Math.round(t*(s.discountValue/100));function A({children:s,className:t,focusStyle:n="indigo",...l}){const r=["w-full border border-gray-300 rounded px-3 py-2 text-sm",{indigo:"focus:ring-indigo-500 focus:border-indigo-500",blue:"focus:outline-none focus:border-blue-500"}[n],t].filter(Boolean).join(" ");return e.jsx("select",{className:r,...l,children:s})}const pe=({couponForm:s,setCouponForm:t,showCouponForm:n,setShowCouponForm:l,handleCouponSubmit:c,addNotification:a})=>n?e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{children:e.jsx(w,{label:"쿠폰명",type:"text",value:s.name,onChange:r=>t({...s,name:r.target.value}),className:"text-sm",placeholder:"신규 가입 쿠폰",required:!0})}),e.jsx("div",{children:e.jsx(w,{label:"쿠폰 코드",type:"text",value:s.code,onChange:r=>t({...s,code:r.target.value.toUpperCase()}),className:"text-sm font-mono",placeholder:"WELCOME2024",required:!0})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs(A,{focusStyle:"indigo",className:"shadow-sm",value:s.discountType,onChange:r=>t({...s,discountType:r.target.value}),children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsx("div",{children:e.jsx(w,{label:me(s.discountType),type:"text",value:s.discountValue===0?"":s.discountValue,onChange:r=>{const{value:i}=r.target;(i===""||/^\d+$/.test(i))&&t({...s,discountValue:i===""?0:parseInt(i)})},onBlur:r=>{const i=parseInt(r.target.value)||0,o=xe(s.discountType,i);o.isValid||(o.errorMessage&&a(o.errorMessage,"error"),t({...s,discountValue:o.correctedValue||0}))},className:"text-sm",placeholder:he(s.discountType),required:!0})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(g,{type:"button",onClick:()=>l(!1),hasTextSm:!0,hasFontMedium:!0,hasRounded:!0,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx(g,{type:"submit",hasTextSm:!0,hasFontMedium:!0,hasRounded:!0,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"쿠폰 생성"})]})]})}):null;function M({children:s,className:t,size:n="xs",rounded:l="none"}){const c={xs:"text-xs",sm:"text-sm"},a={none:"",sm:"rounded",full:"rounded-full"},r=[c[n],a[l],t].filter(Boolean).join(" ");return e.jsx("span",{className:r,children:s})}function S({children:s,className:t="",padding:n="sm",header:l,headerStyle:c="margin",contentPadding:a=!0}){const d=["bg-white rounded-lg border border-gray-200",{none:"",sm:"p-4",md:"p-6"}[l&&!a?"none":n],t].filter(Boolean).join(" ");return e.jsxs("section",{className:d,children:[l&&(c==="border"?e.jsx("div",{className:"p-6 border-b border-gray-200",children:l}):l),s]})}const je=({coupons:s,selectedCoupon:t,setSelectedCoupon:n,addCoupon:l,removeCoupon:c,addNotification:a})=>{const[r,i]=x.useState(!1),[o,d]=x.useState($),p=m=>{m.preventDefault(),l(o,a),d($),i(!1)};return e.jsx(S,{padding:"md",headerStyle:"border",contentPadding:!1,header:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"}),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[s.map(m=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:m.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:m.code}),e.jsx("div",{className:"mt-2",children:e.jsx(M,{size:"sm",rounded:"full",className:"inline-flex items-center px-3 py-1 font-medium bg-white text-indigo-700",children:ue(m)})})]}),e.jsx(g,{onClick:()=>{c(m.code,a),t?.code===m.code&&n(null)},hasTransition:!0,className:"text-gray-400 hover:text-red-600",children:e.jsx(ne,{})})]})},m.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs(g,{onClick:()=>i(!r),className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[e.jsx(ae,{}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),e.jsx(pe,{couponForm:o,setCouponForm:d,showCouponForm:r,setShowCouponForm:i,handleCouponSubmit:p,addNotification:a})]})})},fe=s=>s>0,ye=s=>s>=0&&s<=9999,be=({editingProduct:s,productForm:t,setProductForm:n,showProductForm:l,setShowProductForm:c,setEditingProduct:a,handleProductSubmit:r,addNotification:i})=>l?e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsx("div",{children:e.jsx(w,{label:"상품명",type:"text",value:t.name,onChange:o=>n({...t,name:o.target.value}),required:!0})}),e.jsx("div",{children:e.jsx(w,{label:"설명",type:"text",value:t.description,onChange:o=>n({...t,description:o.target.value})})}),e.jsx("div",{children:e.jsx(w,{label:"가격",type:"text",value:t.price===0?"":t.price,onChange:o=>{const{value:d}=o.target;(d===""||/^\d+$/.test(d))&&n({...t,price:d===""?0:parseInt(d)})},onBlur:o=>{const{value:d}=o.target;d===""?n({...t,price:0}):fe(parseInt(d))||(i("가격은 0보다 커야 합니다","error"),n({...t,price:0}))},placeholder:"숫자만 입력",required:!0})}),e.jsx("div",{children:e.jsx(w,{label:"재고",type:"text",value:t.stock===0?"":t.stock,onChange:o=>{const{value:d}=o.target;(d===""||/^\d+$/.test(d))&&n({...t,stock:d===""?0:parseInt(d)})},onBlur:o=>{const{value:d}=o.target;d===""?n({...t,stock:0}):ye(parseInt(d))||(parseInt(d)<0?(i("재고는 0보다 커야 합니다","error"),n({...t,stock:0})):(i("재고는 9999개를 초과할 수 없습니다","error"),n({...t,stock:9999})))},placeholder:"숫자만 입력",required:!0})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[t.discounts.map((o,d)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:o.quantity,onChange:p=>{const m=[...t.discounts];m[d].quantity=parseInt(p.target.value)||0,n({...t,discounts:m})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:o.rate*100,onChange:p=>{const m=[...t.discounts];m[d].rate=(parseInt(p.target.value)||0)/100,n({...t,discounts:m})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx(g,{type:"button",onClick:()=>{const p=t.discounts.filter((m,f)=>f!==d);n({...t,discounts:p})},className:"text-red-600 hover:text-red-800",children:e.jsx(B,{})})]},d)),e.jsx(g,{type:"button",onClick:()=>{n({...t,discounts:[...t.discounts,{quantity:10,rate:.1}]})},hasTextSm:!0,className:"text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(g,{type:"button",onClick:()=>{a(null),n(L),c(!1)},hasTextSm:!0,hasFontMedium:!0,hasRounded:!0,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx(g,{type:"submit",hasTextSm:!0,hasFontMedium:!0,hasRounded:!0,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:s==="new"?"추가":"수정"})]})]})}):null,Ne=(s,t)=>{const{discounts:n}=s.product,{quantity:l}=s,c=n.reduce((r,i)=>l>=i.quantity&&i.rate>r?i.rate:r,0);return t.some(r=>r.quantity>=10)?Math.min(c+.05,.5):c},E=(s,t)=>{const{price:n}=s.product,{quantity:l}=s,c=Ne(s,t);return Math.round(n*l*(1-c))},I=(s,t)=>{const n=t.find(c=>c.product.id===s.id);return s.stock-(n?.quantity||0)},ve=s=>s.product.price*s.quantity,O=(s,t,n,l,c)=>{if(t&&l&&c){const a=l.find(r=>r.id===t);if(a&&I(a,c)<=0)return"SOLD OUT"}return n?`${s.toLocaleString()}원`:`₩${s.toLocaleString()}`},Ce=({products:s,cart:t,addProduct:n,updateProduct:l,deleteProduct:c,addNotification:a})=>{const[r,i]=x.useState(!1),[o,d]=x.useState(null),[p,m]=x.useState(L),f=u=>{u.preventDefault(),o&&o!=="new"?(l(o,p,a),d(null)):n(p,a),m(L),i(!1)},k=u=>{d(u.id),m({name:u.name,description:u.description||"",price:u.price,stock:u.stock,discounts:u.discounts}),i(!0)};return e.jsxs(S,{padding:"md",headerStyle:"border",contentPadding:!1,header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx(g,{onClick:()=>{d("new"),m(L),i(!0)},hasTextSm:!0,hasRounded:!0,className:"px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800",children:"새 상품 추가"})]}),children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(u=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O(u.price,u.id,!0,s,t)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs(M,{size:"xs",rounded:"full",className:`inline-flex items-center px-2.5 py-0.5 font-medium ${u.stock>10?"bg-green-100 text-green-800":u.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[u.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:u.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx(g,{onClick:()=>k(u),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx(g,{onClick:()=>c(u.id,a),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},u.id))})]})}),e.jsx(be,{editingProduct:o,productForm:p,setProductForm:m,showProductForm:r,setShowProductForm:i,setEditingProduct:d,handleProductSubmit:f,addNotification:a})]})},we=({products:s,cart:t,coupons:n,selectedCoupon:l,setSelectedCoupon:c,addProduct:a,updateProduct:r,deleteProduct:i,addCoupon:o,removeCoupon:d,addNotification:p})=>{const[m,f]=x.useState("products");return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx(ce,{activeTab:m,setActiveTab:f}),m==="products"?e.jsx(Ce,{products:s,cart:t,addProduct:a,updateProduct:r,deleteProduct:i,addNotification:p}):e.jsx(je,{coupons:n,selectedCoupon:l,setSelectedCoupon:c,addCoupon:o,removeCoupon:d,addNotification:p})]})},ke=s=>s.length===0?0:Math.max(...s.map(t=>t.rate))*100,Se=s=>{const[t]=s;return t?`${t.quantity}개 이상 구매시 할인 ${t.rate*100}%`:""},Te=(s,t)=>s-t>0,Me=(s,t)=>s-t,z=(s,t)=>s<t,De=(s,t)=>z(s,t)?Math.round((1-s/t)*100):0,Le=({item:s,cart:t,handleUpdateQuantity:n,removeFromCart:l})=>{const c=E(s,t),a=ve(s),r=z(c,a),i=De(c,a);return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:s.product.name}),e.jsx(g,{onClick:()=>l(s.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:e.jsx(B,{})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{onClick:()=>n(s.product.id,s.quantity-1),hasRounded:!0,className:"w-6 h-6 border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"−"})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:s.quantity}),e.jsx(g,{onClick:()=>n(s.product.id,s.quantity+1),hasRounded:!0,className:"w-6 h-6 border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"+"})})]}),e.jsxs("div",{className:"text-right",children:[r&&e.jsxs(M,{size:"xs",rounded:"none",className:"text-red-500 font-medium block",children:["-",i,"%"]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(c).toLocaleString(),"원"]})]})]})]})},Ve=({cart:s,handleUpdateQuantity:t,removeFromCart:n})=>e.jsx(S,{padding:"sm",headerStyle:"margin",header:e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(se,{}),"장바구니"]}),children:s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(te,{}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):e.jsx("div",{className:"space-y-3",children:s.map(l=>e.jsx(Le,{item:l,cart:s,handleUpdateQuantity:t,removeFromCart:n},l.product.id))})}),qe=({coupons:s,selectedCoupon:t,setSelectedCoupon:n,handleApplyCoupon:l})=>e.jsx(S,{padding:"sm",headerStyle:"margin",header:e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx(g,{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),children:s.length>0&&e.jsxs(A,{focusStyle:"blue",value:t?.code||"",onChange:c=>{const a=s.find(r=>r.code===c.target.value);a?l(a):n(null)},children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),s.map(c=>e.jsxs("option",{value:c.code,children:[c.name," (",c.discountType==="amount"?`${c.discountValue.toLocaleString()}원`:`${c.discountValue}%`,")"]},c.code))]})}),Ie=({totals:s,handleCompleteOrder:t})=>e.jsxs(S,{padding:"sm",headerStyle:"margin",header:e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsxs("span",{className:"font-medium",children:[s.totalBeforeDiscount.toLocaleString(),"원"]})]}),Te(s.totalBeforeDiscount,s.totalAfterDiscount)&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",Me(s.totalBeforeDiscount,s.totalAfterDiscount).toLocaleString(),"원"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[s.totalAfterDiscount.toLocaleString(),"원"]})]})]}),e.jsxs(g,{onClick:t,hasFontMedium:!0,hasTransition:!0,hasRounded:!0,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md hover:bg-yellow-500",children:[s.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]}),Be=({cart:s,coupons:t,selectedCoupon:n,setSelectedCoupon:l,handleApplyCoupon:c,handleCompleteOrder:a,handleUpdateQuantity:r,removeFromCart:i,totals:o})=>e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsx(Ve,{cart:s,handleUpdateQuantity:r,removeFromCart:i}),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{coupons:t,selectedCoupon:n,setSelectedCoupon:l,handleApplyCoupon:c}),e.jsx(Ie,{totals:o,handleCompleteOrder:a})]})]}),Re=s=>s.isRecommended||!1,Pe=({product:s,isAdmin:t,products:n,cart:l,handleAddToCart:c,remainingStock:a})=>e.jsxs(S,{padding:"none",className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx(ee,{})}),Re(s)&&e.jsx(M,{size:"xs",rounded:"sm",className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1",children:"BEST"}),s.discounts.length>0&&e.jsxs(M,{size:"xs",rounded:"sm",className:"absolute top-2 left-2 bg-orange-500 text-white px-2 py-1",children:["~",ke(s.discounts),"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:O(s.price,s.id,t,n,l)}),s.discounts.length>0&&e.jsx("p",{className:"text-xs text-gray-500",children:Se(s.discounts)})]}),e.jsxs("div",{className:"mb-3",children:[a<=5&&a>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",a,"개 남음"]}),a>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",a,"개"]})]}),e.jsx(g,{onClick:()=>c(s),disabled:a<=0,hasFontMedium:!0,hasTransition:!0,hasRounded:!0,className:`w-full py-2 px-4 rounded-md ${a<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:a<=0?"품절":"장바구니 담기"})]})]},s.id),$e=({debouncedSearchTerm:s,isAdmin:t,products:n,cart:l,handleAddToCart:c,getRemainingStock:a})=>{const r=s?n.filter(i=>i.name.toLowerCase().includes(s.toLowerCase())||i.description&&i.description.toLowerCase().includes(s.toLowerCase())):n;return e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",n.length,"개 상품"]})]}),r.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',s,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(i=>{const o=a(i,l);return e.jsx(Pe,{product:i,isAdmin:t,products:n,cart:l,handleAddToCart:c,remainingStock:o},i.id)})})]})},Ae=({debouncedSearchTerm:s,isAdmin:t,products:n,cart:l,coupons:c,selectedCoupon:a,setSelectedCoupon:r,handleAddToCart:i,handleApplyCoupon:o,handleCompleteOrder:d,handleUpdateQuantity:p,removeFromCart:m,getRemainingStock:f,totals:k})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx($e,{debouncedSearchTerm:s,isAdmin:t,products:n,cart:l,handleAddToCart:i,getRemainingStock:f})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Be,{cart:l,coupons:c,selectedCoupon:a,setSelectedCoupon:r,handleApplyCoupon:o,handleCompleteOrder:d,handleUpdateQuantity:p,removeFromCart:m,totals:k})})]});function R(s,t){const[n,l]=x.useState(()=>{const a=localStorage.getItem(s);if(a)try{return JSON.parse(a)}catch{return t}return t}),c=a=>{try{const r=a instanceof Function?a(n):a;l(r)}catch(r){console.error(`Error setting localStorage key "${s}":`,r)}};return x.useEffect(()=>{n==null?localStorage.removeItem(s):Array.isArray(n)?n.length>0?localStorage.setItem(s,JSON.stringify(n)):localStorage.removeItem(s):localStorage.setItem(s,JSON.stringify(n))},[s,n]),[n,c]}function Ee(s=[]){const[t,n]=R("cart",[]),[l,c]=x.useState(null),[a,r]=x.useState(0);x.useEffect(()=>{const u=t.reduce((h,j)=>h+j.quantity,0);r(u)},[t]);const i=x.useCallback(()=>{let u=0,h=0;return t.forEach(j=>{const v=j.product.price*j.quantity;u+=v,h+=E(j,t)}),l&&(l.discountType==="amount"?h=Math.max(0,h-l.discountValue):h=Math.round(h*(1-l.discountValue/100))),{totalBeforeDiscount:Math.round(u),totalAfterDiscount:Math.round(h)}},[t,l]),o=x.useCallback((u,h)=>{n(j=>{if(I(u,j)<=0)return h?.("재고가 부족합니다!","error"),j;const C=j.find(y=>y.product.id===u.id);if(C){const y=C.quantity+1;return y>u.stock?(h?.(`재고는 ${u.stock}개까지만 있습니다.`,"error"),j):j.map(b=>b.product.id===u.id?{...b,quantity:y}:b)}return[...j,{product:u,quantity:1}]}),h?.("장바구니에 담았습니다","success")},[n]),d=x.useCallback(u=>{n(h=>h.filter(j=>j.product.id!==u))},[n]),p=x.useCallback((u,h,j)=>{if(h<=0){d(u);return}const v=s.find(y=>y.id===u);if(!v)return;const C=v.stock;if(h>C){j?.(`재고는 ${C}개까지만 있습니다.`,"error");return}n(y=>y.map(b=>b.product.id===u?{...b,quantity:h}:b))},[s,d,n]),m=x.useCallback((u,h)=>{const{totalAfterDiscount:j}=i();if(u.discountType==="percentage"&&j<1e4){h?.("percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.","error");return}c(u),h?.("쿠폰이 적용되었습니다.","success")},[i,c]),f=x.useCallback(u=>{const h=`ORD-${Date.now()}`;u?.(`주문이 완료되었습니다. 주문번호: ${h}`,"success"),n([]),c(null)},[n]),k=x.useCallback(()=>{n([]),c(null)},[n]);return{cart:t,selectedCoupon:l,setSelectedCoupon:c,totalItemCount:a,calculateCartTotal:i,addToCart:o,removeFromCart:d,updateQuantity:p,applyCoupon:m,getRemainingStock:I,clearCart:k,completeOrder:f}}function Oe(){const[s,t]=R("coupons",oe),n=x.useCallback((a,r)=>{if(!de(a.code,s)){r?.("이미 존재하는 쿠폰 코드입니다.","error");return}t(i=>[...i,a]),r?.("쿠폰이 추가되었습니다.","success")},[s,t]),l=x.useCallback((a,r)=>{t(i=>i.filter(o=>o.code!==a)),r?.("쿠폰이 삭제되었습니다.","success")},[t]),c=x.useCallback((a,r)=>ge(a,r),[]);return{coupons:s,addCoupon:n,removeCoupon:l,getCouponDiscountAmount:c}}function ze(){const[s,t]=R("products",ie),n=x.useCallback((a,r)=>{const i={...a,id:`p${Date.now()}`};t(o=>[...o,i]),r?.("상품이 추가되었습니다.","success")},[t]),l=x.useCallback((a,r,i)=>{t(o=>o.map(d=>d.id===a?{...d,...r}:d)),i?.("상품이 수정되었습니다.","success")},[t]),c=x.useCallback((a,r)=>{t(i=>i.filter(o=>o.id!==a)),r?.("상품이 삭제되었습니다.","success")},[t]);return{products:s,addProduct:n,updateProduct:l,deleteProduct:c}}function He(s,t){const[n,l]=x.useState(s);return x.useEffect(()=>{const c=setTimeout(()=>{l(s)},t);return()=>clearTimeout(c)},[s,t]),n}const We=()=>{const{products:s,addProduct:t,updateProduct:n,deleteProduct:l}=ze(),[c,a]=x.useState([]),r=x.useCallback((N,T="success")=>{const D=Date.now().toString();a(q=>[...q,{id:D,message:N,type:T}]),setTimeout(()=>{a(q=>q.filter(X=>X.id!==D))},3e3)},[]),{cart:i,selectedCoupon:o,setSelectedCoupon:d,totalItemCount:p,calculateCartTotal:m,addToCart:f,removeFromCart:k,updateQuantity:u,applyCoupon:h,getRemainingStock:j,completeOrder:v}=Ee(s),{coupons:C,addCoupon:y,removeCoupon:b}=Oe(),H=x.useCallback(N=>{f(N,r)},[f,r]),W=x.useCallback((N,T)=>{u(N,T,r)},[u,r]),J=x.useCallback(N=>{h(N,r)},[h,r]),U=x.useCallback(()=>{v(r)},[v,r]),[V,Q]=x.useState(!1),[P,_]=x.useState(""),G=He(P,500),K=m();return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(le,{notifications:c,onRemoveNotification:N=>a(T=>T.filter(D=>D.id!==N))}),e.jsx(re,{isAdmin:V,searchTerm:P,setSearchTerm:_,setIsAdmin:Q,cart:i,totalItemCount:p}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:V?e.jsx(we,{products:s,cart:i,coupons:C,selectedCoupon:o,setSelectedCoupon:d,addProduct:t,updateProduct:n,deleteProduct:l,addCoupon:y,removeCoupon:b,addNotification:r}):e.jsx(Ae,{debouncedSearchTerm:G,isAdmin:V,products:s,cart:i,coupons:C,selectedCoupon:o,setSelectedCoupon:d,handleAddToCart:H,handleApplyCoupon:J,handleCompleteOrder:U,handleUpdateQuantity:W,removeFromCart:k,getRemainingStock:j,totals:K})})]})};Y.createRoot(document.getElementById("root")).render(e.jsx(Z.StrictMode,{children:e.jsx(We,{})}));
